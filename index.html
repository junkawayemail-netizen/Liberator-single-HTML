<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Liberator Junk Removal</title>
    <meta name="description" content="Elite junk removal operations in the Bay Area." />
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'brand-blue': 'rgb(var(--color-brand-blue) / <alpha-value>)',
              'brand-green': 'rgb(var(--color-brand-green) / <alpha-value>)',
              'brand-light': 'rgb(var(--color-brand-light) / <alpha-value>)',
              'brand-dark': 'rgb(var(--color-brand-dark) / <alpha-value>)',
            },
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              heading: ['Montserrat', 'sans-serif'],
            },
            backgroundImage: {
              'hero-pattern': "url('https://images.unsplash.com/photo-1503174971373-b1f69850bded?q=80&w=1600&auto=format&fit=crop')",
              'subtle-gradient': "radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.5) 0%, rgba(255, 255, 255, 0) 50%), radial-gradient(circle at 80% 90%, rgba(220, 230, 250, 0.4) 0%, rgba(220, 230, 250, 0) 40%)"
            }
          }
        }
      }
    </script>
    
    <!-- Google Variables -->
    <script src="config.js"></script>
    
    <!-- Babel Standalone for in-browser JSX/TS compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      :root {
        /* Default Theme: Arctic Ops (RGB values for opacity support) */
        --color-brand-blue: 71 85 105;   /* Slate 600 */
        --color-brand-green: 14 165 233; /* Sky 500 */
        --color-brand-light: 255 255 255;
        --color-brand-dark: 15 23 42;    /* Slate 900 */
      }

      body {
        background-color: rgb(var(--color-brand-light));
        background-attachment: fixed;
        transition: background-color 0.5s ease;
      }
      
      /* Smooth transition for color changes */
      *, *::before, *::after {
        transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, box-shadow;
        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        transition-duration: 300ms;
      }

      /* Custom scrollbar for webkit */
      ::-webkit-scrollbar {
        width: 10px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 5px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #555;
      }
      
      .animate-spin-slow {
        animation: spin 3s linear infinite;
      }
      @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
    </style>
    
    <script type="importmap">
    {
      "imports": {
        "framer-motion": "https://aistudiocdn.com/framer-motion@^12.23.25",
        "react": "https://aistudiocdn.com/react@^19.2.1",
        "react-dom/client": "https://aistudiocdn.com/react-dom@^19.2.1/client",
        "@google/genai": "https://aistudiocdn.com/@google/genai@^1.31.0"
      }
    }
    </script>
  </head>
  <body class="text-brand-dark bg-subtle-gradient">
    <div id="root"></div>

    <script type="text/babel" data-type="module" data-presets="typescript,react">
      import React, { useState, useEffect, useRef, createContext, useContext } from 'react';
      import ReactDOM from 'react-dom/client';
      import { motion, AnimatePresence } from 'framer-motion';
      import { GoogleGenAI } from "@google/genai";

      // --- CONFIGURATION ---
      // API key is injected at deploy time via config.js
      window.process = window.process || {};
      window.process.env = window.process.env || {};

      if (window.GOOGLE_API_KEY) {
        window.process.env.API_KEY = window.GOOGLE_API_KEY;
      } else {
        console.warn("API key missing — check config.js / GitHub secret.");
      }

      // --- CONSTANTS ---
      const NAV_LINKS = [
        { href: "#pricing", label: "Pricing" },
        { href: "#services", label: "Services" },
        { href: "#work", label: "Our Work" },
        { href: "#reviews", label: "Intel" },
        { href: "#about", label: "Why Us" },
        { href: "#contact", label: "Contact" }
      ];

      const PRICING_PLANS = [
        { title: "Single Item", price: "$99+", description: "Perfect for a mattress, sofa, or appliance.", },
        { title: "1/4 Truck Load", price: "$249", description: "Fits about 2 pickup truck beds of junk.", },
        { title: "1/2 Truck Load", price: "$399", description: "Our most common choice for bigger cleanouts.", popular: true, },
        { title: "Full Truck", price: "$599", originalPrice: "$799", promo: "Save $200", description: "Seasonal special for entire estate, garage, or office cleanouts.", },
      ];

      const HEAVY_ITEMS_SURCHARGES = [
        { item: "Piano (Upright)", price: "+$250 surcharge" },
        { item: "Piano (Grand)", price: "+$450 surcharge" },
        { item: "Pool Table", price: "+$300 surcharge" },
        { item: "Hot Tub", price: "+$350 surcharge" },
        { item: "Safe (Heavy)", price: "+$200 surcharge" },
        { item: "Construction Debris (Dense)", price: "Custom Quote (Heavy Load)" }
      ];

      const SERVICES = [
        { title: "Turnover Cleanouts", iconPath: "M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" },
        { title: "Furniture Removal", iconPath: "M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" },
        { title: "Appliance Recycling", iconPath: "M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" },
        { title: "Yard Waste Disposal", iconPath: "M14.121 15.121A3 3 0 0112 16.5c-1.282 0-2.45-.8-2.873-2.022M7.5 7.5a3 3 0 013-3h3a3 3 0 013 3v3a3 3 0 01-3 3h-3a3 3 0 01-3-3v-3z" },
        { title: "Construction Debris", iconPath: "M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" },
        { title: "E-Waste Recycling", iconPath: "M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" },
        { title: "General Junk", iconPath: "M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" },
        { title: "Move Out Cleaning", iconPath: "M10 3L7.5 7.5 3 10l4.5 2.5L10 17l2.5-4.5L17 10l-4.5-2.5z" }
      ];

      const WORK_EXAMPLES = [
        { title: "Garage Cleanout", beforeImg: "https://images.unsplash.com/photo-1596484552993-84192dd21726?q=80&w=600&auto=format&fit=crop", afterImg: "https://images.unsplash.com/photo-1533090161767-e6ffed986c88?q=80&w=600&auto=format&fit=crop" },
        { title: "Backyard Debris", beforeImg: "https://images.unsplash.com/photo-1621255556201-923f7956424e?q=80&w=600&auto=format&fit=crop", afterImg: "https://images.unsplash.com/photo-1558904541-efa843a96f01?q=80&w=600&auto=format&fit=crop" },
        { title: "Estate Liquidation", beforeImg: "https://images.unsplash.com/photo-1605518216938-7f31b8af7880?q=80&w=600&auto=format&fit=crop", afterImg: "https://images.unsplash.com/photo-1502005229762-cf1b2da7c5d6?q=80&w=600&auto=format&fit=crop" },
        { title: "Hoarder Room", beforeImg: "https://images.unsplash.com/photo-1584622650111-993a426fbf0a?q=80&w=600&auto=format&fit=crop", afterImg: "https://images.unsplash.com/photo-1507089947368-19c1da9775ae?q=80&w=600&auto=format&fit=crop" },
        { title: "Basement Purge", beforeImg: "https://images.unsplash.com/photo-1526367790999-0150786686a2?q=80&w=600&auto=format&fit=crop", afterImg: "https://images.unsplash.com/photo-1600585154340-be6161a56a0c?q=80&w=600&auto=format&fit=crop" },
        { title: "Office Liquidation", beforeImg: "https://images.unsplash.com/photo-1627916607164-7b5267ad824f?q=80&w=600&auto=format&fit=crop", afterImg: "https://images.unsplash.com/photo-1497366216548-37526070297c?q=80&w=600&auto=format&fit=crop" }
      ];

      const JUNK_TARGETS = [
        { name: "Sofa / Armchair", imgSrc: "https://images.unsplash.com/photo-1555041469-a586c61ea9bc?q=80&w=600&auto=format&fit=crop" },
        { name: "Upright Piano", imgSrc: "https://images.unsplash.com/photo-1520523830771-70e3bf3c716c?q=80&w=600&auto=format&fit=crop" },
        { name: "Mattress", imgSrc: "https://images.unsplash.com/photo-1631049552057-403cdb8f0658?q=80&w=600&auto=format&fit=crop" },
        { name: "Old Appliances", imgSrc: "https://images.unsplash.com/photo-1571175443880-49e1d58b794a?q=80&w=600&auto=format&fit=crop" },
        { name: "Pool Table", imgSrc: "https://images.unsplash.com/photo-1596426724673-94c633bc0c94?q=80&w=600&auto=format&fit=crop" },
        { name: "Construction Debris", imgSrc: "https://images.unsplash.com/photo-1518709594023-6eab9bab7b23?q=80&w=600&auto=format&fit=crop" }
      ];

      const TEAM = [
        { imgSrc: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=400&auto=format&fit=crop", name: 'Alex "Commander" Chen', role: "Founder & Lead Strategist" },
        { imgSrc: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=400&auto=format&fit	crop", name: 'Maria "Breaker" Garcia', role: "Operations Specialist" },
        { imgSrc: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?q=80&w=400&auto=format&fit=crop", name: 'Sam "Gadget" Jones', role: "Eco-Disposal Expert" },
        { imgSrc: "https://images.unsplash.com/photo-1580489944761-15a19d654956?q=80&w=400&auto=format&fit=crop", name: "Jessica Riley", role: "Customer Relations" }
      ];

      const TESTIMONIALS = [
        { id: 1, name: "Sarah Jenkins", location: "Mission District", rating: 5, text: "Liberator arrived at 0800 hours sharp. The squad cleared my garage in under 45 minutes. Total tactical victory over clutter." },
        { id: 2, name: "Mike Ross", location: "Oakland", rating: 5, text: "I needed a quick deployment for an office cleanout. The team was disciplined, efficient, and left the area spotless. Highly recommend." },
        { id: 3, name: "Elena V.", location: "Daly City", rating: 5, text: "Price was exactly as estimated by the General. No hidden fees, no civilian nonsense. Just pure results." }
      ];

      const FAQS = [
        { question: "What is your deployment range?", answer: "We operate throughout the entire San Francisco Bay Area, including SF proper, East Bay, Peninsula, and Marin. If you're on the map, we can reach you." },
        { question: "Do you handle hazardous materials (HazMat)?", answer: "Negative. We are not equipped for biohazards, paint, oil, or asbestos. We can only neutralize standard junk, furniture, and e-waste." },
        { question: "How fast can you mobilize?", answer: "We offer same-day and next-day deployment in most sectors. Call us before 1000 hours for the best chance of same-day service." },
        { question: "Do I need to be on-site for the operation?", answer: "Not necessarily. If the target payload is accessible (curbside or driveway), we can execute the mission remotely and send you photographic confirmation of the neutralized area." }
      ];

      // --- ADMIN CONTEXT ---
      const AdminContext = createContext(undefined);

      const AdminProvider = ({ children }) => {
        const [isAdmin, setIsAdmin] = useState(false);
        const [images, setImages] = useState({});

        useEffect(() => {
          const savedImages = localStorage.getItem('site_images');
          if (savedImages) {
            setImages(JSON.parse(savedImages));
          }
          const session = localStorage.getItem('admin_session');
          if (session === 'active') setIsAdmin(true);
        }, []);

        const login = (password) => {
          if (password === 'ComeInsideMeNow609') {
            setIsAdmin(true);
            localStorage.setItem('admin_session', 'active');
            return true;
          }
          return false;
        };

        const logout = () => {
          setIsAdmin(false);
          localStorage.removeItem('admin_session');
        };

        const updateImage = (key, base64) => {
          const newImages = { ...images, [key]: base64 };
          setImages(newImages);
          localStorage.setItem('site_images', JSON.stringify(newImages));
        };

        return (
          <AdminContext.Provider value={{ isAdmin, login, logout, images, updateImage }}>
            {children}
          </AdminContext.Provider>
        );
      };

      const useAdmin = () => {
        const context = useContext(AdminContext);
        if (!context) {
          throw new Error('useAdmin must be used within an AdminProvider');
        }
        return context;
      };

      // --- COMPONENTS ---
      /* -------------- many components unchanged, omitted here for brevity in explanation -------------- */
      /* The only changes you asked for are to the catch blocks in AIEstimator and AIEstimatorModal.     */
      /* Below I show those full functions with updated catch blocks.                                   */

      const AIEstimator = ({ onBookNow }) => {
        const [description, setDescription] = useState('');
        const [image, setImage] = useState(null);
        const [imagePreview, setImagePreview] = useState(null);
        const [loading, setLoading] = useState(false);
        const [result, setResult] = useState(null);
        const fileInputRef = useRef(null);

        const handleFileChange = (e) => {
          if (e.target.files && e.target.files[0]) {
            const file = e.target.files[0];
            setImage(file);
            const reader = new FileReader();
            reader.onloadend = () => setImagePreview(reader.result);
            reader.readAsDataURL(file);
          }
        };

        const generateEstimate = async () => {
          if (!description && !image) return;
          setLoading(true);
          setResult(null);
          try {
            const ai = new GoogleGenAI({ apiKey: window.process.env.API_KEY });
            const parts = [];
            if (image) {
              const reader = new FileReader();
              await new Promise((r) => {
                reader.onloadend = () => {
                  parts.push({
                    inlineData: {
                      data: reader.result.split(',')[1],
                      mimeType: image.type,
                    },
                  });
                  r();
                };
                reader.readAsDataURL(image);
              });
            }
            parts.push({
              text: `Analyze intel. Estimate junk removal cost for: ${description}. Check for heavy items (concrete/piano) and add $0.20/lb surcharge. Show base + surcharge math.`
            });
            const response = await ai.models.generateContent({
              model: 'gemini-2.5-flash',
              contents: { parts },
              config: {
                systemInstruction: 'You are "The General". Concise. Show the math.',
                thinkingConfig: { thinkingBudget: 0 },
              },
            });
            setResult(response.text);
          } catch (e) {
            console.error("Gemini API error:", e);
            setResult("AI error – see console for details.");
          } finally {
            setLoading(false);
          }
        };

        /* ...rest of AIEstimator component unchanged... */
      };

      /* ...all other components unchanged... */

      const AIEstimatorModal = ({ isOpen, onClose, onBookNow }) => {
        const [description, setDescription] = useState('');
        const [image, setImage] = useState(null);
        const [imagePreview, setImagePreview] = useState(null);
        const [loading, setLoading] = useState(false);
        const [result, setResult] = useState(null);
        const fileInputRef = useRef(null);

        const handleFileChange = (e) => {
          if (e.target.files && e.target.files[0]) {
            const file = e.target.files[0];
            setImage(file);
            const reader = new FileReader();
            reader.onloadend = () => setImagePreview(reader.result);
            reader.readAsDataURL(file);
          }
        };

        const generateEstimate = async () => {
          if (!description && !image) return;
          setLoading(true);
          setResult(null);
          try {
            const ai = new GoogleGenAI({ apiKey: window.process.env.API_KEY });
            const parts = [];
            if (image) {
              const reader = new FileReader();
              await new Promise((r) => {
                reader.onloadend = () => {
                  parts.push({
                    inlineData: {
                      data: reader.result.split(',')[1],
                      mimeType: image.type,
                    },
                  });
                  r();
                };
                reader.readAsDataURL(image);
              });
            }
            parts.push({
              text: `Analyze intel. Estimate junk removal cost for: ${description}. Check for heavy items (concrete/piano) and add $0.20/lb surcharge. Show base + surcharge math.`
            });
            const response = await ai.models.generateContent({
              model: 'gemini-2.5-flash',
              contents: { parts },
              config: {
                systemInstruction: 'You are "The General". Concise. Show the math.',
                thinkingConfig: { thinkingBudget: 0 },
              },
            });
            setResult(response.text);
          } catch (e) {
            console.error("Gemini API error (modal):", e);
            setResult("AI error – see console for details.");
          } finally {
            setLoading(false);
          }
        };

        /* ...rest of AIEstimatorModal component unchanged... */
      };

      /* finally App + render (unchanged) */
      const App = () => <AdminProvider><AppContent /></AdminProvider>;
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
